//this script is for the microbit that is not connected to usb(but is connected to battery) to send message wirelessly
//you can compile it into a hex file using the online mbed compiler https://os.mbed.com/compiler

#include "MicroBit.h"
#include "MicroBitAccelerometer.h"
#include <vector>
#include <string>

MicroBit uBit;
MicroBitI2C i2c = MicroBitI2C(I2C_SDA0, I2C_SCL0); 
MicroBitAccelerometer accelerometer = MicroBitAccelerometer(i2c);



ManagedString getAccelerometerVectors()
{
    ManagedString accelerometerVectorsString = "";
    vector<int> accelerometerVectors;
    accelerometerVectors.push_back(uBit.accelerometer.getX());
    accelerometerVectors.push_back(uBit.accelerometer.getY());
    accelerometerVectors.push_back(uBit.accelerometer.getZ());
    for (int i = 0; i < accelerometerVectors.size(); ++i)
    {
        accelerometerVectorsString = accelerometerVectorsString + (ManagedString)accelerometerVectors[i] + ',';
    }
    return accelerometerVectorsString;
}
void sendData()
{
    uBit.radio.datagram.send(getAccelerometerVectors());
}  

int main()
{
    uBit.init();
    uBit.radio.enable();
    while(1)
    {
        sendData();
        uBit.sleep(20);  
             
    }
}
